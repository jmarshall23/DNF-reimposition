/*******************************************************************************
 * dnGrenade_Cycloid_Mortar generated by Eliot.UELib using UELib.CLI.
 * Eliot.UELib Â© 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class dnGrenade_Cycloid_Mortar extends dnRocket_RPG_HeatSeek
	collapsecategories
	dependson(dnGrenade_Cycloid_Mortar_Mini);

var float ExplosionDelay;
var int SpawnCount;
var() float ExplodeDist;
var float MortarDamage;
var float MortarDamageRadius;

event PostBeginPlay()
{
	super(InteractiveActor).PostBeginPlay();
	__NFUN_605__(3, false, 'TurnOnCollision');
	return;
}

final function TurnOnCollision()
{
	__NFUN_621__(false, false, false, true);
	return;
}

event KImpact(name SelfBoneName, KarmaActor Other, name OtherBoneName, Vector Position, Vector ImpactVelocity, Vector ImpactNormal)
{
	super(Projectile).KImpact(SelfBoneName, Other, OtherBoneName, Position, ImpactVelocity, ImpactNormal);
	return;
}

function Engage()
{
	// End:0x0B
	if(__NFUN_145__(bEngaged))
	{
	}
	super.Engage();
	return;
}

event Tick(float DeltaSeconds)
{
	super.Tick(DeltaSeconds);
	// End:0x19
	if(__NFUN_339__(Target, none))
	{
		return;
	}
	// End:0x48
	if(__NFUN_200__(__NFUN_252__(__NFUN_239__(Target.Location, Location)), __NFUN_195__(ExplodeDist, ExplodeDist)))
	{
		doit();
	}
	return;
}

final function doit()
{
	ExecuteExplode(Location, __NFUN_232__(0, 0, 1), none);
	return;
}

function FlyInRandomDir()
{
	super.FlyInRandomDir();
	return;
}

simulated function DoDamage(Vector HitLocation, Actor HitActor)
{
	local int i;
	local dnGrenade_Cycloid_Mortar_Mini Mini;
	local Vector Dir;
	local Rotator SpawnRot;

	super(Projectile).DoDamage(HitLocation, HitActor);
	__NFUN_615__(class'Cycloid_Mortar_BlindingExplosion', Instigator,, Location, Rotation);
	SpawnRot = Rotation;
	// End:0x69
	if(__NFUN_340__(Target, none))
	{
		Dir = __NFUN_253__(__NFUN_239__(Target.Location, Location));
		SpawnRot = Rotator(Dir);
	}
	i = 0;
	J0x70:

	// End:0xF1 [Loop If]
	if(__NFUN_169__(i, SpawnCount))
	{
		Mini = __NFUN_615__(class'dnGrenade_Cycloid_Mortar_Mini', Instigator,, __NFUN_238__(Location, __NFUN_234__(__NFUN_255__(), 35)), SpawnRot);
		Mini.ForceTarget(Target);
		Mini.Damage = MortarDamage;
		Mini.DamageRadius = MortarDamageRadius;
		__NFUN_184__(i);
		// [Loop Continue]
		goto J0x70;
	}
	return;
}

event RegisterPrecacheComponents(PrecacheIndex PrecacheIndex)
{
	super(dnRocket).RegisterPrecacheComponents(PrecacheIndex);
	PrecacheIndex.__NFUN_1266__(class'Cycloid_Mortar_BlindingExplosion');
	PrecacheIndex.__NFUN_1266__(class'dnGrenade_Cycloid_Mortar_Mini');
	return;
}

defaultproperties
{
	ExplosionDelay=0.5
	SpawnCount=8
	ExplodeDist=500
	MortarDamage=55
	MortarDamageRadius=130
	EngageDelay=0.6
	ReseekDelay=0.1
	SeekTimeLimit=1.25
	SeekDistance=10000
	Speed=900
	ExplosionClass='p_Creatures.cycloid.Cycloid_CarpetbombBreakaway_Spawner'
	MountOnSpawn(0)=(bSkipVerifySelf=false,SpawnClass='dnGame.Weapon_LightEx_Rocket_HeatSeek',SpawnChance=0,MountPrefab=(bDontActuallyMount=false,bHideable=false,bIndependentRotation=false,bIndependentLocation=false,bMatchParentLocation=false,bMatchParentRotation=false,bSurviveDismount=false,bDontScaleByDrawScale=false,bScaleByDrawScaleNonDefault=false,bTransformDrawScale3DChange=false,bTakeParentTag=false,bTransferToCorpse=false,bDontSetOwner=false,MountParentTag=None,DrawScaleOverride=0,AppendToTag=None,ForceTag=None,ForceEvent=None,MountMeshItem=None,MountOrigin=(X=1.298303E-41,Y=3.789392E-17,Z=0),Z=-6),MountOriginVariance=(X=1.298303E-41,Y=3.773024E-17,Z=0),Z=0)
	MountOnSpawn(1)=(MountAngles=(Pitch=8754,Yaw=574554112,Roll=0),Roll=-16384)
	MountOnSpawn(2)=(MountAnglesVariance=(Pitch=8754,Yaw=574554112,Roll=0),Roll=0)
	MountOnSpawn(3)=(MountType=0,DismountPhysics=0)
	MountOnSpawn(4)=(RenderObject=none,DrawScale=0)
	StaticMesh='sm_class_decorations.AlienGrenade.AlienGrenade'
}